---
layout: post
title: Linux tip - du versus df
date: 2009-10-12 10:20:02.000000000 -07:00
type: post
published: true
status: publish
categories:
- Tech
- Tip
tags:
- Tech
author:
  login: addumb
  email: adam@addumb.com
  display_name: addumb
  first_name: ''
  last_name: ''
---
<p>If a server says it's low on disk space but you can't find the offending file(s), try checking the output of lsof for "(deleted)". Some services out there really really hate it when you poorly rotate logs and delete the old ones from under them.</p>
<p>Check free space:<br />
<code>[root@server ~]# df -h<br />
Filesystem            Size  Used Avail Use% Mounted on<br />
/dev/sda1              65G   52G  9.6G  85% /<br />
tmpfs                 2.0G     0  2.0G   0% /dev/shm<br />
</code></p>
<p>Grasping at straws, check lsof:<br />
<code><br />
[root@server ~]# lsof -p 2586 | grep "(deleted)"<br />
lighttpd 2586 lighttpd    6w   REG    8,1    33973933 7548243 /var/log/lighttpd/someotheraccesslog (deleted)<br />
/etc/init.d/restart restart</code></p>
<p>Check fix:<br />
<code>[root@server ~]# df -h<br />
Filesystem            Size  Used Avail Use% Mounted on<br />
/dev/sda1              65G   16G   46G  26% /<br />
tmpfs                 2.0G     0  2.0G   0% /dev/shm</code></p>
<p>All done!</p>
